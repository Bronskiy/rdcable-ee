(function(global,$){"use strict";var Freeform=global.Freeform=global.Freeform||{};Freeform.shortName=function(a){var b="",c="_",f="",d={223:"ss",224:"a",225:"a",226:"a",229:"a",227:"ae",230:"ae",228:"ae",231:"c",232:"e",233:"e",234:"e",235:"e",236:"i",237:"i",238:"i",239:"i",241:"n",242:"o",243:"o",244:"o",245:"o",246:"oe",249:"u",250:"u",251:"u",252:"ue",255:"y",257:"aa",269:"ch",275:"ee",291:"gj",299:"ii",311:"kj",316:"lj",326:"nj",353:"sh",363:"uu",382:"zh",256:"aa",268:"ch",274:"ee",290:"gj",298:"ii",310:"kj",315:"lj",325:"nj",352:"sh",362:"uu",381:"zh"};if(b!==""){if(a.substr(0,b.length)==b){a=a.substr(b.length)}}a=a.toLowerCase();b=0;for(var g=a.length;b<g;b++){var e=a.charCodeAt(b);if(e>=32&&e<128){f+=a.charAt(b)}else if(d.hasOwnProperty(e)){f+=d[e]}}d=new RegExp(c+"{2,}","g");a=f;a=a.replace("/<(.*?)>/g","");a=a.replace(/\s+/g,c);a=a.replace(/\//g,c);a=a.replace(/[^a-z0-9\-\_]/g,"");a=a.replace(/\+/g,c);a=a.replace(d,c);a=a.replace(/-$/g,"");a=a.replace(/_$/g,"");a=a.replace(/^_/g,"");a=a.replace(/^-/g,"");a=a.replace(/\.+$/g,"");return a};Freeform.insertToTextarea=function(field,insert,ie){ie=ie||false;if(!ie&&typeof field.selectionEnd!=="undefined"&&!isNaN(field.selectionEnd)){var selLength=field.textLength;var selStart=field.selectionStart;var selEnd=field.selectionEnd;var s1=field.value.substring(0,selStart);var s2=field.value.substring(selStart,selEnd);var s3=field.value.substring(selEnd,selLength);var newStart=selStart+insert.length;field.value=s1+insert+s3;field.focus();field.selectionStart=newStart;field.selectionEnd=newStart}else if(document.selection){field.focus();document.selection.createRange().text=insert;field.blur();field.focus()}else{field.value+=insert}};Freeform.tabTextarea=function(event,node){var tabSpace="    ";if(event.keyCode==9){if(typeof event.preventDefault!=="undefined"){event.preventDefault()}var height=node.scrollTop;event.returnValue=false;if(node.setSelectionRange){var d=node.selectionStart+4;node.value=node.value.substring(0,node.selectionStart)+tabSpace+node.value.substring(node.selectionEnd,node.value.length);setTimeout(function(){node.focus();node.setSelectionRange(d,d)},0)}else{node.focus();document.selection.createRange().text=tabSpace;node.blur();node.focus()}node.scrollTop=height;node.focus()}};Freeform.autoGenerateShortname=function($label,$name,$autoGenerateCheckbox){var autoGenerate=$label.val().length==0;if($autoGenerateCheckbox&&$autoGenerateCheckbox["length"]){autoGenerate=$autoGenerateCheckbox.attr("checked")=="checked";$autoGenerateCheckbox.change(function(){autoGenerate=$autoGenerateCheckbox.attr("checked")=="checked";if(autoGenerate){$label.keyup()}})}$label.keyup(function(){if(autoGenerate){$name.val(Freeform.shortName($label.val()))}}).keyup()};Freeform.formPrep=function(str){return $.trim(str.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))};function autoDupeLastInput($parentHolder,input_class){var timer=0;$parentHolder.find(".freeform_delete_button:last").hide();$parentHolder.on("keyup","."+input_class+" input",function(){var that=this;clearTimeout(timer);timer=setTimeout(function(){var $that=$(that),$parent=$that.parent();if($.trim($that.val())!==""&&$parent.is($("."+input_class+":last",$parentHolder))){var $newHolder=$parent.clone();$newHolder.find("input").each(function(i,item){var $input=$(this);if($input.is('[type="text"]')){$input.val("")}else{if($input.attr("selected")){$input.attr("selected",false)}if($input.attr("checked")){$input.attr("checked",false)}}var match=/([a-zA-Z\_\-]+)\[([0-9]+)\]/gi.exec($(this).attr("name"));if(match){$(this).attr("name",match[1]+"["+(parseInt(match[2],10)+1)+"]")}});$parent.parent().append($newHolder);$parent.find(".freeform_delete_button").show()}},250)})}Freeform.autoDupeLastInput=autoDupeLastInput;function carryOverInputs(oldType,newType,prefix){if(newType=="channel_field"||oldType=="channel_field"){return}var data=[];var $nld_ta=$('textarea[name="'+prefix+'_list_nld_textarea_input"]');var $list=$('input[name*="'+prefix+'_list_holder_input"]');var $lvList=$('input[name*="'+prefix+'_list_value_holder_input"]');var $llList=$('input[name*="'+prefix+'_list_label_holder_input"]');var $vlHolder=$("#"+prefix+"_type_value_label_holder");var $listHolder=$("#"+prefix+"_type_list_holder");var i;var l;if(oldType=="nld_textarea"){var temp_data=$nld_ta.val().split(/\n\r|\n|\r/gi);for(i=0,l=temp_data.length;i<l;i++){var trimmed=temp_data[i];if(trimmed!==""){data.push(trimmed)}}}else if(oldType=="value_label"){$llList.each(function(){var trimmed=$(this).val();if(trimmed!==""){data.push(trimmed)}})}else if(oldType=="list"){$list.each(function(){var trimmed=$(this).val();if(trimmed!==""){data.push(trimmed)}})}if(data.length===0){return}var $inputs;var $clone;if(newType=="nld_textarea"){$nld_ta.val(data.join("\n"))}else if(newType=="value_label"){var vlHoldover={};$llList.each(function(i){var that_label=Freeform.formPrep($llList.eq(i).val());var that_value=Freeform.formPrep($lvList.eq(i).val());if(that_label!==""&&that_value!==""){vlHoldover[that_label]=that_value}});$inputs=$(".value_label_holder_input",$vlHolder);$clone=$inputs.eq(0).clone();$inputs.remove();data.push("");for(i=0,l=data.length;i<l;i++){var shortname=Freeform.shortName(data[i]);if(shortname===""){shortname=data[i]}var $item=$clone.clone();var $value=$item.find('input[name*="'+prefix+'_list_value_holder_input"]');var $label=$item.find('input[name*="'+prefix+'_list_label_holder_input"]');$value.attr("name",prefix+"_list_value_holder_input["+i+"]").val(typeof vlHoldover[data[i]]!=="undefined"?vlHoldover[data[i]]:shortname);$label.attr("name",prefix+"_list_label_holder_input["+i+"]").val(data[i]);$vlHolder.append($item)}$vlHolder.find(".freeform_delete_button").show().last().hide()}else if(newType=="list"){$inputs=$(".list_holder_input",$listHolder);$clone=$inputs.eq(0).clone();$inputs.remove();data.push("");for(i=0,l=data.length;i<l;i++){$listHolder.append($clone.clone().find('input[name*="'+prefix+'_list_holder_input"]').val(data[i]).end())}$listHolder.find(".freeform_delete_button").show().last().hide()}}Freeform.setupMultiRowDelegate=function(currentChoice,prefix){currentChoice=currentChoice||"list";prefix=prefix||"";$("body").on("fieldTypeChanged",function(event,type){if(type!=prefix){return}var $listType=$("#"+prefix+"_list_type");var $listTypeSelect=$('select[name="'+prefix+'_list_type"]');var $listHolders=$("#"+prefix+"_option_holder > div");var $typeListHolder=$("#"+prefix+"_type_list_holder");var $typeKvlHolder=$("#"+prefix+"_type_value_label_holder");var $typeNLDTholder=$("#"+prefix+"_type_nld_textarea_holder");var listTypes=[];$listTypeSelect.find("option").each(function(){listTypes.push($(this).val())});autoDupeLastInput($typeListHolder,"list_holder_input");autoDupeLastInput($typeKvlHolder,"value_label_holder_input");$listHolders.on("click",".freeform_delete_button",function(){$(this).parent().remove()});$listHolders.hide();var fieldTypeGroups=[];$.each(listTypes,function(item,i){var $that=$("#"+prefix+"_type_"+item+"_holder");var type=item;if(type==currentChoice){$that.addClass("active");$that.show()}});$listTypeSelect.change(function(e){var type=$listTypeSelect.val();var $that=$("#"+prefix+"_type_"+type+"_holder");$listHolders.removeClass("active");$that.addClass("active");$listHolders.hide();$that.show();carryOverInputs(currentChoice,type,prefix);if(type!="channel_field"){currentChoice=type}$listType.val(type);e.preventDefault();return false}).change()})};$.fn.sortElements=$.fn.sortElements||function(){var sort=[].sort;return function(comparator,getSortable){getSortable=getSortable||function(){return this};var placements=this.map(function(){var sortElement=getSortable.call(this),parentNode=sortElement.parentNode,nextSibling=parentNode.insertBefore(document.createTextNode(""),sortElement.nextSibling);return function(){if(parentNode===this){return}parentNode.insertBefore(this,nextSibling);parentNode.removeChild(nextSibling)}});return sort.call(this,comparator).each(function(i){placements[i].call(getSortable.call(this))})}}();$.fn.outerHTML=$.fn.outerHTML||function(){return $(this)[0].outerHTML};$.fn.removeTags=$.fn.removeTags||function(){this.each(function(){if(jQuery(this).children().length===0){jQuery(this).replaceWith(jQuery(this).text())}else{jQuery(this).children().unwrap()}});return this};Freeform.jQUIDialog=function(options){options=$.extend({message:"No Message Defined",ok:"OK",title:"Alert",preventDefault:true,immediate:false,modal:true},options);var buttonsOptions={};var dialogInstalled=typeof $.fn.dialog!=="undefined";var $dialog=$("<div></div>").html(options.message);if(dialogInstalled){if(typeof options.cancel!=="undefined"){buttonsOptions[options.cancel]={click:function(){if(typeof options.cancelClick!=="undefined"){options.cancelClick()}$(this).dialog("close")},"class":"submit btn ",text:options.cancel}}buttonsOptions[options.ok]={click:function(){if(typeof options.close!=="undefined"){options.close()}if(typeof options.okClick!=="undefined"){options.okClick()}$(this).dialog("close")},"class":"submit btn action",text:options.ok};$dialog.dialog({autoOpen:false,title:options.title,buttons:buttonsOptions,dialogClass:"ss_jqui_dialog",zIndex:50,modal:options.modal,close:function(){$(".ui-dialog.ss_jqui_dialog").remove()}})}var returnFunction=function(e){if(e&&options.preventDefault){e.preventDefault()}if(dialogInstalled){$dialog.dialog("open")}else{window.alert(options.message)}if(e&&options.preventDefault){return false}};if(options.immediate){returnFunction()}else{return returnFunction}};Freeform.setUpChosenSelect=function($context){return};Freeform.elementSearch=function(searchFieldQuery,resultElementQuery,onQuery,onAttr){var $searchField=$(searchFieldQuery);var $resultElements=$(resultElementQuery);$searchField.bind("keyup",function(e){var $that=$(this);if($that.val()===""||$that.attr("placeholder")&&$that.val()==$that.attr("placeholder")){$resultElements.show()}else{$resultElements.hide()}var search=new RegExp($that.val().toLowerCase());$resultElements.filter(function(index){var $this=$(this),$searchOn=$this,find;if(onQuery){$searchOn=$searchOn.find(onQuery)}if(onAttr!="html"&&onAttr!="text"&&$searchOn.attr(onAttr)){find=$searchOn.attr(onAttr)}else if(onAttr=="text"){find=$searchOn.text()}else{find=$searchOn.html()}return search.exec(find.toLowerCase())}).show()});$searchField.bind("keydown",function(e){if(e.keyCode==13){return false}});return $searchField};Freeform.strRepeat=function(str,num){var ret="";while(num--){ret+=str}return ret};Freeform.fractionToFloat=function(numerator,denominator,base){base=base||100;return Math.round(100*(numerator/denominator*base))/100};Freeform.getUrlArgs=function(url){url=url||window.location.href;var urlVars={};var parts=url.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){urlVars[key]=value});return urlVars};var cycleSwtiches=[];Freeform.cycle=function(items){if(!$.isArray(items)){items=Array.prototype.slice.call(arguments)}var hash=items.join("|");if(typeof cycleSwtiches[hash]==="undefined"||typeof items[cycleSwtiches[hash]+1]==="undefined"){cycleSwtiches[hash]=0}else{cycleSwtiches[hash]++}return items[cycleSwtiches[hash]]};Freeform.clearCycle=function(){cycleSwtiches=[];return this};Freeform.showValidationErrors=function(errors){var outHtml="<ul>";var errorHolder=$("#freeform-shared-model-errors");errorHolder.html("Error building errors.");$.each(errors,function(i,item){outHtml+="<li>";outHtml+=$.isArray(item)?item.join("</li><li>"):item;outHtml+="</li>"});errorHolder.html(outHtml);$(".freeform-error-modal").trigger("modal:open")};$(function(){$("body").on("click",".freeform_notice .notice_close",function(e){e.preventDefault();$(this).parent().slideUp();return false});$('input[name="form_fields[]"]:first, input[name="form_ids[]"]:first').parents(".setting-field").addClass("scroll-wrap");var $fancyWrapper=$("#fancybox-content");var $solspaceWrapper=$("#mainContent .solspace_ui_wrapper:first")})})(window,jQuery);